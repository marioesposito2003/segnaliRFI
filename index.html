<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editor Linee Ferroviarie RFI - Sistema Segnali</title>
    <meta name="description" content="Editor avanzato per costruire linee ferroviarie personalizzate e praticare con il sistema di segnalamento RFI">
    <link rel="icon" type="image/x-icon" href="assets/images/favicon.ico">
    <link rel="stylesheet" href="assets/css/styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Header principale -->
    <header class="header">
        <div class="container">
            <h1>üèóÔ∏è Editor Linee Ferroviarie RFI</h1>
            <p>Sistema avanzato per costruire e utilizzare linee ferroviarie personalizzate - Segnalamento Italiano</p>
        </div>
    </header>

    <!-- Container principale -->
    <main class="container">
        <!-- Informazioni esercizio/stato -->
        <div class="exercise-status">
            <div class="status-header">
                <span class="exercise-counter" id="exerciseCounter">Editor Linee Ferroviarie</span>
                <span class="difficulty-badge" id="difficultyBadge">Sistema Personalizzato</span>
            </div>
        </div>

        <!-- Area principale dell'editor -->
        <div class="exercise-info">
            <!-- Contenuto generato dinamicamente dall'editor -->
            <div class="loading-message">
                <h3>üîÑ Caricamento Editor...</h3>
                <p>Inizializzazione sistema linee ferroviarie in corso...</p>
            </div>
        </div>

        <!-- Visualizzazione binario (per modalit√† esercizio) -->
        <div class="track-visualization" style="display: none;">
            <h4>üõ§Ô∏è Binario da Segnalare</h4>
            <div class="track-info">
                <span id="trackInfo">Informazioni percorso</span>
            </div>
            <div class="railway-layout" id="railwayLayout">
                <div class="main-track"></div>
            </div>
            <div class="signal-positions" id="signalPositions">
                <!-- Posizioni segnali generate dinamicamente -->
            </div>
        </div>

        <!-- Controlli (per modalit√† esercizio) -->
        <div class="controls" style="display: none;">
            <!-- Selezione segnali -->
            <div class="signal-selection">
                <h4>üö¶ Segnali Disponibili</h4>
                <div class="system-selector">
                    <button class="system-btn active" onclick="switchSystemType()">
                        üîÑ Sistema: <span id="currentSystemDisplay">2 aspetti</span>
                    </button>
                </div>
                <div class="signal-categories" id="signalCategories">
                    <!-- Categorie segnali caricate da signals.js -->
                </div>
            </div>

            <!-- Pulsanti controllo -->
            <div class="control-buttons">
                <button class="control-btn primary" onclick="checkSolution()">
                    ‚úÖ Verifica Soluzione
                </button>
                <button class="control-btn secondary" onclick="resetExercise()">
                    üîÑ Reset Esercizio
                </button>
                <button class="control-btn" onclick="saveSolution()">
                    üíæ Salva Soluzione
                </button>
                <button class="control-btn hint" onclick="showOtherSolutions()">
                    üë• Altre Soluzioni
                </button>
            </div>
        </div>

        <!-- Risultati e spiegazioni -->
        <div class="results" id="results">
            <h3 id="resultsTitle">Risultati</h3>
            <div class="results-grid" id="resultsGrid">
                <!-- Risultati della verifica -->
            </div>
            <div class="explanation" id="explanation">
                <!-- Spiegazioni dettagliate -->
            </div>
        </div>

        <!-- Progressi e statistiche -->
        <div class="progress-container" style="display: none;">
            <div class="progress-info">
                <h4>üìä Progressi Sessione</h4>
                <div class="stats-grid">
                    <div class="stat-item">
                        <span class="stat-label">Linee Create:</span>
                        <span class="stat-value" id="createdRailways">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Esercizi Completati:</span>
                        <span class="stat-value" id="completedExercises">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Soluzioni Salvate:</span>
                        <span class="stat-value" id="savedSolutions">0</span>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>üèóÔ∏è Editor Linee Ferroviarie RFI</h4>
                    <p>Sistema avanzato per costruzione e simulazione linee ferroviarie personalizzate</p>
                </div>
                <div class="footer-section">
                    <h4>üîß Funzionalit√†</h4>
                    <ul>
                        <li>Editor drag & drop</li>
                        <li>Canvas con griglia</li>
                        <li>Elementi ferroviari completi</li>
                        <li>Database condiviso</li>
                        <li>Sistema segnali RFI</li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>üìö Supporto</h4>
                    <ul>
                        <li>2 e 3 aspetti</li>
                        <li>Export/Import database</li>
                        <li>Soluzioni collaborative</li>
                        <li>Design responsive</li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 Sistema Editor Linee Ferroviarie RFI - Strumento per formazione e simulazione</p>
                <p>üöÇ Versione avanzata con editor personalizzato e database condiviso</p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="assets/js/signals.js"></script>
    <script src="assets/js/exercises.js"></script>
    <script src="assets/js/main.js"></script>

    <!-- Script di inizializzazione -->
    <script>
        // Funzione di inizializzazione globale
        window.addEventListener('load', function() {
            console.log('üöÄ Inizializzazione completata');
            
            // Rimuove messaggio di caricamento dopo inizializzazione
            setTimeout(() => {
                const loadingMsg = document.querySelector('.loading-message');
                if (loadingMsg && typeof initializeRailwayEditor === 'function') {
                    loadingMsg.style.display = 'none';
                }
            }, 1000);
        });

        // Gestione errori JavaScript
        window.addEventListener('error', function(e) {
            console.error('‚ùå Errore JavaScript:', e.error);
            const loadingMsg = document.querySelector('.loading-message');
            if (loadingMsg) {
                loadingMsg.innerHTML = `
                    <h3>‚ùå Errore di Caricamento</h3>
                    <p>Si √® verificato un errore durante l'inizializzazione.</p>
                    <button onclick="location.reload()" class="control-btn primary">üîÑ Ricarica Pagina</button>
                `;
            }
        });

        // Debug utilities
        window.debugEditor = function() {
            return {
                railwayEditor: window.RAILWAY_EDITOR,
                appState: window.APP_STATE,
                elements: window.RAILWAY_ELEMENTS,
                customRailways: JSON.parse(localStorage.getItem('rfi_custom_railways') || '[]'),
                solutions: JSON.parse(localStorage.getItem('rfi_signal_solutions') || '[]')
            };
        };

        console.log('üèóÔ∏è Editor Linee Ferroviarie RFI caricato');
        console.log('üîß Usa window.debugEditor() per informazioni di debug');
    </script>
</body>
</html> 